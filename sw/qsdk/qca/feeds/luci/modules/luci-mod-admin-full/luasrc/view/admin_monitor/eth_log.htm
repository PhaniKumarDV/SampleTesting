<%#
 Copyright 2008 Steven Barth <steven@midlink.org>
 Copyright 2008 Jo-Philipp Wich <jow@openwrt.org>
 Licensed to the public under the Apache License 2.0.
-%>
<%+header%>

<script type="text/javascript">
function get_data(data)
{
    var a = data.split(",");
    for(i=0; i<a.length; i++)
        a[i].replace(" ","");
    document.getElementById("result").innerHTML  = "Packets transmitted : "+a[0]+"&#10;";
    document.getElementById("result").innerHTML += "Packets received : "+a[1]+"&#10;";
    document.getElementById("result").innerHTML += "Packets transmit failure : "+a[2]+"&#10;";
    document.getElementById("result").innerHTML += "Packets receive failure : "+a[3]+"&#10;";
    document.getElementById("result").innerHTML += "Packets receive CRC errors : "+a[4]+"&#10;";
    document.getElementById("result").innerHTML += "Packets receive frame oversize errors : "+a[5]+"&#10;";
    document.getElementById("result").innerHTML += "Packets receive frame overrun errors : "+a[6]+"&#10;";
    document.getElementById("result").innerHTML += "Multicast packets transmitted : "+a[7]+"&#10;";
    document.getElementById("result").innerHTML += "Multicast packets received : "+a[8]+"&#10;";
    document.getElementById("result").innerHTML += "Unicast packets transmitted : "+a[9]+"&#10;";
    document.getElementById("result").innerHTML += "Unicast packets received : "+a[10];
}

function get_results()
{
    var id = document.getElementById("logtype").value;
    XHR.get('<%=luci.dispatcher.build_url("admin", "monitor", "stats")%>/eth_logtype' + '/' + id, null,
	function(x, data) {
		if (data) {
            if( id == 3 ) 
                get_data(data);
            else
			    document.getElementById("result").innerHTML=data;
		}
	}
    );
}
function clear_log()
{
    var id = document.getElementById("logtype").value;
    XHR.get('<%=luci.dispatcher.build_url("admin", "monitor", "stats")%>/eth_clrlog' + '/' + id, null,
	function(x, data) {
		if (data) { 
            if( id == 3 ) 
                get_data(data);
            else
			    document.getElementById("result").innerHTML=data;
		}
	}
    );
}
</script>
<div class="page-content">
<h2><a id="content" name="content"><%:Statistics%></a></h2>
    <ul class="cbi-tabmenu">
        <li style="margin-right:4px" class="cbi-tab-disabled"><a href="<%=luci.dispatcher.build_url("admin/monitor/stats")%>"><%:Wireless%></a></li>
        <li style="margin-right:4px" class="cbi-tab"><a href="#"><%:Ethernet%></a></li>
        <li style="margin-right:4px" class="cbi-tab-disabled"><a href="radio1stats"><%:5GHz Radio%></a></li>
        <li style="margin-right:4px" class="cbi-tab-disabled"><a href="radio2stats"><%:2.4GHz Radio%></a></li>
    </ul>
<div class="cbi-page-actions left" style="padding-left: 19px;">
    Show log type
    <select id="logtype" style="width: 250px">
        <option value=1>Network Statistics for all Interfaces</option>
        <option value=2>Display Ethernet Statistics</option>
        <option value=3>Display Ethernet Advanced Statistics</option>
    </select>
    <input type="button" id="s1" class="cbi-button cbi-button-apply" value="<%:Submit%>" onclick="get_results()" />
    <input type="button" id="s2" class="cbi-button cbi-button-apply" value="<%:Refresh%>" onclick="get_results()" />
    <input type="button" id="s3" class="cbi-button" value="<%:Clear%>" onclick="clear_log()" />
</div>
<div>&nbsp;</div>
<div id="content_syslog">
<textarea readonly="readonly" wrap="off" style="width:100%; height:500px;" rows="<%=eth_log:cmatch("\n")+2%>" id="result"><%=eth_log:pcdata()%></textarea>
</div>
</div>
<%+footer%>
